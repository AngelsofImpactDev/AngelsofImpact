<?php include('ue-config/ue-globalconfig.php');include('ue-config/ue-globalconnect.php');include('ue-config/ue-globalfunction.php');$namaTableDatabase='product';$namaTableDatabaseId=$namaTableDatabase.'_id';$currentServerTime=time();if($ue_globvar_https_enabled){$protocol='https';}else{$protocol='http';}$limitPrdNum=50000;$urlStrFinal='';$currentLastMod=date("Y-m-d",$currentServerTime);$defaultUrl=array();$defaultUrl[]=array('loc'=>'index','lastmod'=>$currentLastMod,'changefreq'=>'weekly','priority'=>'1.0');$limitPrdNum-=1;switch($ue_globvar_sitemap_mode){case 'news':$namaTableDatabase='news';$sitemapQue=ue_query("SELECT ".$namaTableDatabase."_id,".$namaTableDatabase."_entrydate,".$namaTableDatabase."_editdate FROM ".$namaTableDatabase." WHERE ".$namaTableDatabase."_enabled = 'e'"." ORDER BY ".$namaTableDatabase."_showorder DESC LIMIT 0,".$limitPrdNum);$sitemapNum=(int)ue_num_rows($sitemapQue);if($sitemapNum>1){while($sitemapRes=ue_fetch_array($sitemapQue)){if($sitemapRes[$namaTableDatabase.'_editdate']>0){$currentLastMod=date("Y-m-d",$sitemapRes[$namaTableDatabase.'_editdate']);}else{$currentLastMod=date("Y-m-d",$sitemapRes[$namaTableDatabase.'_entrydate']);}$defaultUrl[]=array('loc'=>'news.php?nid='.$sitemapRes[$namaTableDatabase.'_id'],'lastmod'=>$currentLastMod,'changefreq'=>'weekly','priority'=>'0.8');}}break;case 'product':$sitemapClassQue=ue_query("SELECT productclass_id FROM productclass WHERE productclass_enabled = 'e'");$sitemapClassNum=(int)ue_num_rows($sitemapClassQue);if($sitemapClassNum>1){while($sitemapClassRes=ue_fetch_array($sitemapClassQue)){$defaultUrl[]=array('loc'=>'?pclass='.$sitemapClassRes['productclass_id'],'lastmod'=>$currentLastMod,'changefreq'=>'weekly','priority'=>'0.5');}$limitPrdNum-=$sitemapClassNum;}$sitemapCateQue=ue_query("SELECT productcategory_id,productcategory.productclass_id FROM productcategory INNER JOIN productclass ON productcategory.productclass_id = productclass.productclass_id WHERE productcategory_enabled = 'e' AND productclass_enabled = 'e'");$sitemapCateNum=(int)ue_num_rows($sitemapCateQue);if($sitemapCateNum>1){while($sitemapCateRes=ue_fetch_array($sitemapCateQue)){$defaultUrl[]=array('loc'=>'?pclass='.$sitemapCateRes['productclass_id'].'&pcategory='.$sitemapCateRes['productcategory_id'],'lastmod'=>$currentLastMod,'changefreq'=>'weekly','priority'=>'0.5');}$limitPrdNum-=$sitemapCateNum;}$sitemapTypeQue=ue_query("SELECT producttype_id,producttype.productcategory_id,productcategory.productclass_id FROM producttype INNER JOIN productcategory ON producttype.productcategory_id = productcategory.productcategory_id INNER JOIN productclass ON productcategory.productclass_id = productclass.productclass_id WHERE producttype_enabled = 'e' AND productcategory_enabled = 'e' AND productclass_enabled = 'e'");$sitemapTypeNum=(int)ue_num_rows($sitemapTypeQue);if($sitemapTypeNum>1){while($sitemapTypeRes=ue_fetch_array($sitemapTypeQue)){$defaultUrl[]=array('loc'=>'?pclass='.$sitemapTypeRes['productclass_id'].'&pcategory='.$sitemapTypeRes['productcategory_id'].'&ptype='.$sitemapTypeRes['producttype_id'],'lastmod'=>$currentLastMod,'changefreq'=>'weekly','priority'=>'0.5');}$limitPrdNum-=$sitemapCateNum;}$sitemapBrandQue=ue_query("SELECT productbrand_id FROM productbrand WHERE productbrand_enabled = 'e'");$sitemapBrandNum=(int)ue_num_rows($sitemapBrandQue);if($sitemapBrandNum>1){while($sitemapBrandRes=ue_fetch_array($sitemapBrandQue)){$defaultUrl[]=array('loc'=>'?pbrand='.$sitemapBrandRes['productbrand_id'],'lastmod'=>$currentLastMod,'changefreq'=>'weekly','priority'=>'0.5');}$limitPrdNum-=$sitemapBrandNum;}$sitemapQue=ue_query("SELECT ".$namaTableDatabase."_id,".$namaTableDatabase."_name,".$namaTableDatabase."_entrydate,".$namaTableDatabase."_editdate FROM ".$namaTableDatabase." WHERE ".$namaTableDatabase."_enabled = 'e' LIMIT 0,".$limitPrdNum);$sitemapNum=(int)ue_num_rows($sitemapQue);if($sitemapNum>1){while($sitemapRes=ue_fetch_array($sitemapQue)){if($sitemapRes['product_editdate']>0){$currentLastMod=date("Y-m-d",$sitemapRes['product_editdate']);}else{$currentLastMod=date("Y-m-d",$sitemapRes['product_entrydate']);}$defaultUrl[]=array('loc'=>urlRewriter('productdetail',$sitemapRes['product_id'],$sitemapRes['product_name']),'lastmod'=>$currentLastMod,'changefreq'=>'monthly','priority'=>'0.8');}}break;}foreach($defaultUrl as $defaultUrlKey=>$defaultUrlVal){$urlStrFinal.='
<url>
	<loc>'.$protocol.'://'.$globvar_address.'/'.htmlentities($defaultUrlVal['loc']).'</loc>
	<lastmod>'.$defaultUrlVal['lastmod'].'</lastmod>
	<changefreq>'.$defaultUrlVal['changefreq'].'</changefreq>
	<priority>'.$defaultUrlVal['priority'].'</priority>
</url>';}$defaultFormat='<?xml version="1.0" encoding="utf-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" 
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd">
    '.$urlStrFinal.'
</urlset>';header('Content-type: application/xml');echo $defaultFormat;@ ue_close($GLOBALS['mysql_connect_init']);?>